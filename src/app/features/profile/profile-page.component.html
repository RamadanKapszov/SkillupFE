<div class="profile-container" *ngIf="!loading && !error; else loadingTpl">
  <div class="profile-header">
    <img
      [src]="user?.avatarUrl || '/assets/img/default-avatar.png'"
      alt="Avatar"
      class="avatar"
    />
    <div>
      <h2>{{ user?.username }}</h2>
      <p>{{ user?.email }}</p>
      <p class="points">üèÜ {{ user?.totalPoints }} —Ç–æ—á–∫–∏</p>
    </div>
  </div>

  <div class="progress-card">
    <h3>üìä –ü—Ä–æ–≥—Ä–µ—Å</h3>
    <div class="progress-bar">
      <div class="progress-fill" [style.width.%]="user?.progressPercent"></div>
    </div>
    <p>{{ user?.progressPercent }}% –∑–∞–≤—ä—Ä—à–µ–Ω–∏ —É—Ä–æ—Ü–∏</p>
  </div>

  <div class="dashboard-sections">
    <div class="section">
      <h3>üß© –ü–æ—Å–ª–µ–¥–Ω–∏ —Ç–µ—Å—Ç–æ–≤–µ</h3>
      <ul>
        <li *ngFor="let t of user?.completedTests">
          <strong>{{ t.title }}</strong> ‚Äî {{ t.score }} —Ç–æ—á–∫–∏
          <small>{{ t.completedAt | date : "dd.MM.yyyy HH:mm" }}</small>
        </li>
      </ul>
    </div>

    <div class="section">
      <h3>üèÖ –ë–∞–¥–∂–æ–≤–µ</h3>
      <div class="badges">
        <div class="badge" *ngFor="let b of user?.badges">
          <img [src]="b.iconUrl" alt="{{ b.name }}" />
          <span>{{ b.name }}</span>
        </div>
      </div>
    </div>

    <div class="profile-section" *ngIf="enrolledCourses?.length">
      <h2>üìò –ú–æ–∏—Ç–µ –∫—É—Ä—Å–æ–≤–µ</h2>
      <div class="courses-list">
        <div class="course-card" *ngFor="let c of enrolledCourses">
          <h3>{{ c.title }}</h3>
          <small>üìÖ –ó–∞–ø–∏—Å–∞–Ω –Ω–∞: {{ c.enrolledAt | date : "dd.MM.yyyy" }}</small>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #loadingTpl>
  <div class="loading">‚è≥ –ó–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ –ø—Ä–æ—Ñ–∏–ª–∞...</div>
</ng-template>
