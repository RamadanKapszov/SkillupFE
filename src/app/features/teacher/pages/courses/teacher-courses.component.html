<div class="page-header">
  <div class="header-left">
    <h1>üéì –ú–æ–∏—Ç–µ –∫—É—Ä—Å–æ–≤–µ</h1>
    <p class="subtitle">
      –£–ø—Ä–∞–≤–ª—è–≤–∞–π —Å–≤–æ–∏—Ç–µ –∫—É—Ä—Å–æ–≤–µ, —Å—ä–∑–¥–∞–≤–∞–π –Ω–æ–≤–æ —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ –∏ –≤–¥—ä—Ö–Ω–æ–≤—è–≤–∞–π
      —Å—Ç—É–¥–µ–Ω—Ç–∏.
    </p>
  </div>
  <button class="btn gradient" (click)="openCreate()">‚ûï –ù–æ–≤ –∫—É—Ä—Å</button>
</div>

<!-- üîç Filter/Search -->
<div class="filters">
  <div class="search-box">
    <input
      type="text"
      placeholder="üîç –¢—ä—Ä—Å–∏ –ø–æ –∑–∞–≥–ª–∞–≤–∏–µ..."
      [(ngModel)]="q"
      (input)="filter()"
    />
  </div>
</div>

<!-- üßæ Courses Grid -->
<div class="courses-grid" *ngIf="filtered.length; else emptyTpl">
  <div class="course-card" *ngFor="let c of filtered">
    <div class="thumb">
      <img
        [src]="c.imageUrl || 'assets/images/default-course.jpg'"
        alt="{{ c.title }}"
      />
      <div class="overlay">
        <a [routerLink]="['/courses', c.id]" class="btn overlay-btn"
          >üëÅÔ∏è –ü—Ä–µ–≥–ª–µ–¥</a
        >
      </div>
    </div>

    <div class="body">
      <h3>{{ c.title }}</h3>
      <p class="muted">{{ c.shortDescription || c.description }}</p>

      <div class="meta">
        <span>üë• {{ c.studentsCount || 0 }} —Å—Ç—É–¥–µ–Ω—Ç–∞</span>
        <span
          >‚≠ê {{ c.averageRating || c.rating || 0 | number : "1.1-2" }}</span
        >
      </div>
    </div>

    <div class="actions">
      <button class="btn ghost" (click)="edit(c)">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–∞–π</button>
      <button class="btn danger" (click)="remove(c.id)">üóëÔ∏è –ò–∑—Ç—Ä–∏–π</button>
    </div>
  </div>
</div>

<!-- üï≥ Empty State -->
<ng-template #emptyTpl>
  <div class="empty">
    <img
      src="assets/images/empty-state.svg"
      alt="No courses"
      class="empty-illustration"
    />
    <h3>–ù—è–º–∞—à —Å—ä–∑–¥–∞–¥–µ–Ω–∏ –∫—É—Ä—Å–æ–≤–µ –≤—Å–µ –æ—â–µ</h3>
    <p>–ó–∞–ø–æ—á–Ω–∏ —Å–≤–æ—è –ø—ä—Ä–≤–∏ –∫—É—Ä—Å –¥–Ω–µ—Å –∏ —Å–ø–æ–¥–µ–ª–∏ –∑–Ω–∞–Ω–∏–µ—Ç–æ —Å–∏ —Å—ä—Å —Å–≤–µ—Ç–∞!</p>
    <button class="btn gradient" (click)="openCreate()">‚ûï –°—ä–∑–¥–∞–π –∫—É—Ä—Å</button>
  </div>
</ng-template>

<!-- ‚úèÔ∏è CREATE / EDIT MODAL -->
<div
  class="modal-backdrop"
  *ngIf="showCreate || showEdit"
  (click)="showCreate ? closeCreate() : closeEdit()"
>
  <div class="modal" (click)="$event.stopPropagation()">
    <h2>{{ showEdit ? "‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–∞–π –∫—É—Ä—Å" : "‚ûï –ù–æ–≤ –∫—É—Ä—Å" }}</h2>
    <p class="muted">
      {{
        showEdit
          ? "–ü—Ä–æ–º–µ–Ω–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è—Ç–∞ –∑–∞ –∫—É—Ä—Å–∞."
          : "–ü–æ–ø—ä–ª–Ω–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è—Ç–∞ –ø–æ-–¥–æ–ª—É, –∑–∞ –¥–∞ —Å—ä–∑–¥–∞–¥–µ—à –Ω–æ–≤ –∫—É—Ä—Å."
      }}
    </p>

    <form [formGroup]="form" (ngSubmit)="showEdit ? update() : create()">
      <div class="grid">
        <label>
          <span>–ó–∞–≥–ª–∞–≤–∏–µ*</span>
          <input formControlName="title" type="text" required />
        </label>

        <label>
          <span>–ö–∞—Ç–µ–≥–æ—Ä–∏—è (ID)*</span>
          <input formControlName="categoryId" type="number" required />
        </label>
      </div>

      <label>
        <span>–ö—Ä–∞—Ç–∫–æ –æ–ø–∏—Å–∞–Ω–∏–µ</span>
        <input formControlName="shortDescription" type="text" />
      </label>

      <label>
        <span>–û–ø–∏—Å–∞–Ω–∏–µ</span>
        <textarea formControlName="description" rows="4"></textarea>
      </label>

      <div class="grid">
        <label>
          <span>–ù–∏–≤–æ</span>
          <input
            formControlName="level"
            type="text"
            placeholder="Beginner / Intermediate / Advanced"
          />
        </label>

        <label>
          <span>–ü—Ä–æ–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ—Å—Ç</span>
          <input
            formControlName="duration"
            type="text"
            placeholder="8h / 12 lessons"
          />
        </label>
      </div>

      <div class="grid">
        <label>
          <span>–ï–∑–∏–∫</span>
          <input formControlName="language" type="text" placeholder="BG / EN" />
        </label>

        <label>
          <span>Image URL</span>
          <input formControlName="imageUrl" type="url" />
        </label>
      </div>

      <label>
        <span>–¢–∞–≥–æ–≤–µ (–∑–∞–ø–µ—Ç–∞–π–∫–∏)</span>
        <input
          formControlName="tags"
          type="text"
          placeholder="c#, dotnet, basics"
        />
      </label>

      <div class="modal-actions">
        <button
          type="button"
          class="btn ghost"
          (click)="showEdit ? closeEdit() : closeCreate()"
        >
          –û—Ç–∫–∞–∂–∏
        </button>
        <button
          type="submit"
          class="btn gradient"
          [disabled]="form.invalid || submitting"
        >
          {{
            submitting
              ? showEdit
                ? "–ó–∞–ø–∞–∑–≤–∞–Ω–µ‚Ä¶"
                : "–°—ä–∑–¥–∞–≤–∞–Ω–µ‚Ä¶"
              : showEdit
              ? "üíæ –ó–∞–ø–∞–∑–∏"
              : "–°—ä–∑–¥–∞–π"
          }}
        </button>
      </div>
    </form>
  </div>
</div>
